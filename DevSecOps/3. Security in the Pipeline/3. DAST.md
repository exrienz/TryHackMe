
## Dynamic Application Security Testing (DAST) Overview

- **Definition:**  
  - *Dynamic Application Security Testing (DAST)* is the process of testing a running web application to identify vulnerabilities by simulating attacks from an external perspective.  
  - Uses a **black-box testing** approach – the tester does not require visibility into the source code.

- **Purpose:**  
  - To discover runtime vulnerabilities such as configuration issues, deployment-specific flaws, and certain logic errors that static analysis may miss.
  - Complements techniques like Static Application Security Testing (SAST) and manual pentesting within a secure development lifecycle.

---

## Manual vs. Automated DAST

- **Manual DAST:**  
  - Conducted by a security engineer.  
  - **Advantages:**  
    - Able to identify context-specific vulnerabilities and business logic flaws that automated tools may miss.  
  - **Disadvantages:**  
    - Time-consuming if applied on every small change.
  
- **Automated DAST:**  
  - Uses tools to scan the application automatically.  
  - **Advantages:**  
    - Quick to run, which is ideal for frequent tests (e.g., per commit).
    - Does not depend on the underlying programming language; works regardless of tech stacks.
    - Helps reduce false positives compared to static tests.
  - **Disadvantages:**  
    - Limited code coverage in some cases.
    - May miss vulnerabilities that require human interpretation.
    - Some applications that rely heavily on JavaScript might be harder to fully crawl.

- **Combined Approach:**  
  - Best results are achieved by integrating both manual and automated processes throughout the Software Development Lifecycle (SDLC).

---

## DAST Process in the SDLC

- **Testing Phases:**  
  - Automated DAST is typically incorporated during testing phases for speed (low-hanging fruit).
  - Manual scans (or traditional pentests) are run periodically or before production deployment.
  
- **Tools in Focus – ZAP Proxy:**  
  - ZAP is used as an example DAST tool that can perform both manual tests and automated scans.

---

## Spidering & Crawling

- **Purpose:**  
  - Map out all accessible URLs, pages, and parameters in the target web application.
  
- **Spidering Techniques in ZAP:**
  - **Regular Spider:**  
    - Navigates through the site using embedded HTML links.
    - Limitations: May miss links generated dynamically with JavaScript.
  - **AJAX Spider:**  
    - Leverages real browsers (such as Firefox or Chrome) to process JavaScript and capture dynamically generated content.
    - To use go to Tools -> AJAX Spider, configure a URL as a starting point and check the options you see fit.
    - **Real-Life Example:**  
      - A modern webapp may use JavaScript to load additional pages. Using AJAX Spider helps discover links like `/nospiders-gallery.php` that a traditional spider might miss.

---

## Vulnerability Scanning

- **Scanning Policy Configuration:**  
  - Customize the scan by setting parameters for:
    - **Threshold:**  
      - Lower thresholds increase sensitivity (more findings but risk of false positives).
      - Higher thresholds provide more certainty at the risk of missing some issues.
    - **Strength:**  
      - Controls the number of tests per category, influencing scan duration.
  - **Customization Example:**  
    - Disable unnecessary tests (e.g., SQL injection) for applications that do not use databases to speed up the scan.

- **Active Scan Execution:**  
  - Initiate a scan on the target URL, letting ZAP send various attack payloads.
  - Review alerts and mark known false positives.

---

## Authenticated Scans

- **Challenge:**  
  - Many areas of an application require login credentials; without authentication, DAST misses secured endpoints.
  
- **Solution Steps in ZAP:**
  - **Recording Authentication:**
    - Use a **ZEST script** to record the login process (e.g., navigating to `/login.php` and submitting valid credentials).
    - *Example Credentials:*  
      - Username: `nospiders`  
      - Password: `nospiders`
  - **Creating a Context:**
    - Define which parts of the site belong to the same testing group.
    - Attach the recorded authentication script to the context for consistent testing.
  - **Additional Adjustments:**
    - **Exclude Logout URLs:**  
      - Prevent ZAP from logging out by excluding pages like `/logout.php`.
    - **Set Logged-In / Logged-Out Indicators:**
      - Define textual cues (like the presence of a logout link on `cowsay.php`) to help ZAP verify session status.
    - **Verification Strategy:**  
      - Use techniques like "Poll the Specified URL" to regularly check session validity.

---

## API Testing with DAST

- **Importance:**  
  - Modern applications often expose APIs that expose unique endpoints which traditional spidering might not discover.
  
- **Approach:**  
  - **Importing API Definitions:**
    - Use standardized descriptions (OpenAPI/Swagger, SOAP, or GraphQL) to define endpoints and parameters.
    - *Example:*  
      - An endpoint like `/asciiart/{art_id}` clearly defines that `art_id` is a required string parameter for GET requests.
  - **Testing:**  
    - Once imported, APIs can be scanned similarly to a regular web application for vulnerabilities.

---

## Integrating DAST into the CI/CD Pipeline

- **Automation Benefits:**  
  - Running DAST automatically on each code commit provides early visibility of security issues.
  
- **Typical Pipeline Setup:**
  - **Components:**
    - **Gitea:** Repository where code is committed.
    - **Jenkins:** CI/CD tool that builds and deploys Docker instances of the application.
  - **Integration with zap2docker:**
    - A Dockerized version of ZAP (zap2docker) is used to run automated scans.
    - **Scan Profiles:**
      - **Baseline Scan:**  
        - Short-duration spidering (e.g., 1 minute) without active scanning.
      - **Full Scan:**  
        - Comprehensive spidering plus active scanning (may take longer).
      - **API Scan:**  
        - Tailored for APIs using the API definition file.
    - **Real-Life Example:**  
      - A Jenkins build incorporating a “Scan with OWASP ZAP” stage can automatically fail if vulnerabilities are found, prompting immediate remediation.

- **Jenkins Pipeline Configuration:**  
  - The Jenkinsfile is modified to include a new stage that runs zap2docker.  
  - Reports generated during the scan help teams quickly identify and prioritize remediation efforts.

---

## Summary & Key Takeaways

- **DAST** is essential for identifying runtime vulnerabilities by simulating an attacker’s perspective.
- A **combined approach** using both manual and automated tests in various SDLC stages maximizes vulnerability detection.
- Tools like **ZAP** allow you to:
  - Spider and scan both public and authenticated areas.
  - Customize scanning policies and test profiles to suit specific application contexts.
- **Integrating DAST into CI/CD pipelines** (using tools like zap2docker and Jenkins) ensures continuous security testing and rapid feedback for development teams.
